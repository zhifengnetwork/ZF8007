<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>注册</title>
		<script type="text/javascript" src="/__STATIC__/js/rem.js" ></script>
		<link rel="stylesheet" type="text/css" href="/__STATIC__/css/public.css"/>
		<link rel="stylesheet" type="text/css" href="/__STATIC__/css/header.css"/>
		<link rel="stylesheet" type="text/css" href="/__STATIC__/css/my/signin.css"/>
	</head>
	<body>
		<div class="everyColor">
			<div class="lb_headWrap">
				<p class="lb_headWrap_return" data-num="1" onclick="returnFun()">
                    <img class="lb_headWrap_return_img" src="/__STATIC__/image/back@2x.png"/> 
                </p>
				<span>手机快速注册</span>
            </div>
            <!---->
            <div class="content">
            	<div class="shortcut">
            		<!--手机号-->
            		<div class="mobile">
            			<div class="mark">手机号:</div>
            			<div class="inp">
                            <input class="text phone" name="mobile" id="mobile" type="text" placeholder="请输入手机号/邮箱/用户名" />
                            <input type="hidden" name="sms_type" value="1" id="sms_type_id">
            			</div>
            		</div>
            		<!--验证码-->
            		<div class="mobile">
            			<div class="mark">验证码:</div>
            			<div class="inp">
            				<input class="text" type="number" name="code" id="code" placeholder="请输入短信验证码" />
            				<input class="gain" type="button" id="btn" value="获取验证码" onclick="settime(this)" />
            			</div>
            		</div>
            		<!--设置密码-->
            		<div class="mobile">
            			<div class="mark">设置密码:</div>
            			<div class="inp">
            				<input class="text" type="number" name="password" id="password" placeholder="数字+字母或符号" />
            			</div>
            		</div>
            	</div>
            	
            	<!--注册按钮-->
            	<a class="signin_btn">提交注册</a>
            </div>
        </div>
        
        <script src="/__STATIC__/js/jquery-1.8.3.js"></script>
        <script src="/__STATIC__/js/public.js"></script>
        <script type="text/javascript" src="/public/static/admin/lib/layer/2.4/layer.js"></script>
        <script>
        	//获取验证码
 			var countdown=60; 
			function settime(val) { 
				if (countdown == 0) { 
					val.removeAttribute("disabled");    
					val.value="免费获取验证码"; 
					countdown = 60;

				} else { 
					val.setAttribute("disabled", true); 
					val.value="重新发送(" + countdown + ")"; 
					countdown--;
				} 
				setTimeout(function() { 
					settime(val) 
				},1000) 
			}

        // //发送验证码
        $("#btn").click(function(){
            var reg = /^1[34578]\d{9}$/;  /*用户手机号*/
            var phone = $(".phone");
            var phoneS = $(".phone").val();
            if (phone.val() == "") {
                layer.msg('手机不能为空!', { time: 1000 }, function () {

                });
                return false
            }
            if (!reg.test(phone.val())) {
                layer.msg('请输入正确的手机号!', { time: 1000 }, function () {

                });
                return false
            }
            var sms_type = $('#sms_type_id').val();

            // 获取验证码
            var flag = true;
            $.ajax({
                url: '/index/login/getPhoneVerify',
                type: 'post',
                dataType: 'json',
                data: { 'phone': phoneS, 'sms_type': sms_type },
                success: function (msg) {
                    if (msg.code == 0) {
                        layer.msg(msg.msg);
                        flag = false;
                        return false;
                    }
                }
            }); 
            if(flag){
                layer.msg('已发送');
            }
            // $(".verify").focus();
            // daojishi(60,$(this))
            // $(".phone").attr("disabled","disabled") 
            // return condition.phonestate=true
        })

        $('.signin_btn').click(function(){
			var mobile = $("#mobile").val();
			var code = $("#code").val();
			var sms_type = $("#sms_type_id").val();
			var password = $("#password").val();									 
            $.ajax({
                url: '/index/login/re_commit',
                type: 'post',
                dataType: 'json',
                data: $("form").serialize(),
                success: function (msg) {
                    if (msg.code == 0) {
                        layer.msg(msg.msg);
                        flag = false;
                        return false;
                    }
                }
            });
		})
        </script>
	</body>
</html>
